# How can we restrict an API to a certain role?
In Spring Framework, you can restrict access to an API endpoint based on user roles using Spring Security. Here are the steps to achieve this:
1. **Add Spring Security Dependency**: Ensure that you have the Spring Security dependency in your project. If you're using Maven, add the following to your `pom.xml`:

2. **Configure Security**: Create a security configuration class that extends `WebSecurityConfigurerAdapter` and override the `configure(HttpSecurity http)` method to define role-based access control.

```java
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;

@Configuration
@EnableWebSecurity
public class SecurityConfig extends WebSecurityConfigurerAdapter {
    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http
            .authorizeRequests()
                .antMatchers("/api/admin/**").hasRole("ADMIN") // Restrict access to ADMIN role
                .antMatchers("/api/user/**").hasAnyRole("USER", "ADMIN") // Allow USER and ADMIN roles
                .anyRequest().authenticated() // All other requests require authentication
            .and()
            .formLogin() // Enable form-based login
            .and()
            .httpBasic(); // Enable basic authentication
    }
}
```

3. **Define Roles**: Ensure that your user details service or authentication provider assigns roles to users appropriately. Roles should be prefixed with "ROLE_" in Spring Security.
4. **Secure API Endpoints**: Use the `@PreAuthorize` annotation on your controller methods to enforce role-based access control at the method level.

```java
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;
@RestController
public class ApiController {
    @GetMapping("/api/admin/data")
    @PreAuthorize("hasRole('ADMIN')")
    public String getAdminData() {o
        return "Admin Data";
    }
    @GetMapping("/api/user/data")
    @PreAuthorize
    public String getUserData() {
        return "User Data";
    }
}
```
